<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EPW Projection — RCP (Web)</title>
  <link rel="stylesheet" href="style.css" />

  <!-- PyScript (Pyodide) -->
  <link rel="stylesheet" href="https://pyscript.net/releases/2024.9.3/core.css">
  <script type="module" src="https://pyscript.net/releases/2024.9.3/core.js"></script>

  <!-- Config: on charge numpy, pandas, matplotlib -->
  <py-config>
    packages = ["numpy", "pandas", "matplotlib"]
  </py-config>
</head>
<body>
  <header>
    <h1>Projection EPW — RCP (Web)</h1>
    <p>Choisissez le scénario/année, chargez un EPW, puis tracez chaque variable. La projection est en rouge. Téléchargez le nouvel EPW en bas.</p>
  </header>

  <section class="controls">
    <div class="control-group">
      <label for="rcp">Scénario RCP</label>
      <select id="rcp">
        <option>RCP2.6</option>
        <option>RCP4.5</option>
        <option>RCP6.0</option>
        <option selected>RCP8.5</option>
      </select>
    </div>

    <div class="control-group">
      <label for="year">Année de projection</label>
      <select id="year">
        <option>2050</option>
        <option selected>2100</option>
      </select>
    </div>

    <div class="control-group file">
      <label for="epwfile">Fichier EPW</label>
      <input type="file" id="epwfile" accept=".epw" />
      <button id="loadBtn">Charger</button>
      <span id="fileInfo">Aucun fichier chargé.</span>
    </div>
  </section>

  <main class="main">
    <aside class="vars">
      <h2>Variables EPW</h2>
      <div id="varsList" class="vars-list">
        <!-- Boutons variables générés ici -->
      </div>
      <div class="export">
        <button id="exportBtn" disabled>Télécharger EPW projeté</button>
        <a id="downloadLink" download="projected.epw" style="display:none;">Télécharger</a>
      </div>
    </aside>

    <section class="plot">
      <h2>Visualisation</h2>
      <div id="plotNote">Axe des x = unité de temps arbitraire (échantillons 1..N). Courbe continue passant par tous les points.</div>
      <div id="plotArea">
        <!-- Matplotlib figure s’affiche ici -->
      </div>
      <div id="status">Prêt.</div>
    </section>
  </main>

  <footer>
    <small>Exécute entièrement dans votre navigateur via PyScript (Pyodide).</small>
  </footer>

  <!-- Code Python -->
  <py-script src="app.py"></py-script>
</body>
</html>
